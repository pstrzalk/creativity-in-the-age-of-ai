// stimulus-hotkeys@2.3.0 downloaded from https://ga.jspm.io/npm:stimulus-hotkeys@2.3.0/dist/index.m.js

function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;"value"in n&&(n.writable=true);Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){t&&_defineProperties(e.prototype,t);r&&_defineProperties(e,r);return e}function _defineProperty(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true}):e[t]=r;return e}function _inherits(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)};return _getPrototypeOf(e)}function _setPrototypeOf(e,t){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){e.__proto__=t;return e};return _setPrototypeOf(e,t)}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?_assertThisInitialized(e):t}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var r,n=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function camelize(e){return e.replace(/(?:[_-])([a-z0-9])/g,((e,t)=>t.toUpperCase()))}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function dasherize(e){return e.replace(/([A-Z])/g,((e,t)=>`-${t.toLowerCase()}`))}function readInheritableStaticArrayValues(e,t){const r=getAncestorsForConstructor(e);return Array.from(r.reduce(((e,r)=>{getOwnStaticArrayValues(r,t).forEach((t=>e.add(t)));return e}),new Set))}function readInheritableStaticObjectPairs(e,t){const r=getAncestorsForConstructor(e);return r.reduce(((e,r)=>{e.push(...getOwnStaticObjectPairs(r,t));return e}),[])}function getAncestorsForConstructor(e){const t=[];while(e){t.push(e);e=Object.getPrototypeOf(e)}return t.reverse()}function getOwnStaticArrayValues(e,t){const r=e[t];return Array.isArray(r)?r:[]}function getOwnStaticObjectPairs(e,t){const r=e[t];return r?Object.keys(r).map((e=>[e,r[e]])):[]}(()=>{function extendWithReflect(e){function extended(){return Reflect.construct(e,arguments,new.target)}extended.prototype=Object.create(e.prototype,{constructor:{value:extended}});Reflect.setPrototypeOf(extended,e);return extended}function testReflectExtension(){const a=function(){this.a.call(this)};const e=extendWithReflect(a);e.prototype.a=function(){};return new e}try{testReflectExtension()}catch(e){return e=>class extended extends e{}}})();function ClassPropertiesBlessing(e){const t=readInheritableStaticArrayValues(e,"classes");return t.reduce(((e,t)=>Object.assign(e,propertiesForClassDefinition(t))),{})}function propertiesForClassDefinition(e){return{[`${e}Class`]:{get(){const{classes:t}=this;if(t.has(e))return t.get(e);{const r=t.getAttributeName(e);throw new Error(`Missing attribute "${r}"`)}}},[`${e}Classes`]:{get(){return this.classes.getAll(e)}},[`has${capitalize(e)}Class`]:{get(){return this.classes.has(e)}}}}function TargetPropertiesBlessing(e){const t=readInheritableStaticArrayValues(e,"targets");return t.reduce(((e,t)=>Object.assign(e,propertiesForTargetDefinition(t))),{})}function propertiesForTargetDefinition(e){return{[`${e}Target`]:{get(){const t=this.targets.find(e);if(t)return t;throw new Error(`Missing target element "${e}" for "${this.identifier}" controller`)}},[`${e}Targets`]:{get(){return this.targets.findAll(e)}},[`has${capitalize(e)}Target`]:{get(){return this.targets.has(e)}}}}function ValuePropertiesBlessing(e){const t=readInheritableStaticObjectPairs(e,"values");const r={valueDescriptorMap:{get(){return t.reduce(((e,t)=>{const r=parseValueDefinitionPair(t);const n=this.data.getAttributeNameForKey(r.key);return Object.assign(e,{[n]:r})}),{})}}};return t.reduce(((e,t)=>Object.assign(e,propertiesForValueDefinitionPair(t))),r)}function propertiesForValueDefinitionPair(e){const t=parseValueDefinitionPair(e);const{key:r,name:n,reader:o,writer:i}=t;return{[n]:{get(){const e=this.data.get(r);return null!==e?o(e):t.defaultValue},set(e){void 0===e?this.data.delete(r):this.data.set(r,i(e))}},[`has${capitalize(n)}`]:{get(){return this.data.has(r)||t.hasCustomDefaultValue}}}}function parseValueDefinitionPair([e,t]){return valueDescriptorForTokenAndTypeDefinition(e,t)}function parseValueTypeConstant(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function parseValueTypeDefault(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}return Array.isArray(e)?"array":"[object Object]"===Object.prototype.toString.call(e)?"object":void 0}function parseValueTypeObject(e){const t=parseValueTypeConstant(e.type);if(t){const r=parseValueTypeDefault(e.default);if(t!==r)throw new Error(`Type "${t}" must match the type of the default value. Given default value: "${e.default}" as "${r}"`);return t}}function parseValueTypeDefinition(e){const t=parseValueTypeObject(e);const r=parseValueTypeDefault(e);const n=parseValueTypeConstant(e);const o=t||r||n;if(o)return o;throw new Error(`Unknown value type "${e}"`)}function defaultValueForDefinition(t){const r=parseValueTypeConstant(t);if(r)return e[r];const n=t.default;return void 0!==n?n:t}function valueDescriptorForTokenAndTypeDefinition(e,n){const o=`${dasherize(e)}-value`;const i=parseValueTypeDefinition(n);return{type:i,key:o,name:camelize(o),get defaultValue(){return defaultValueForDefinition(n)},get hasCustomDefaultValue(){return void 0!==parseValueTypeDefault(n)},reader:t[i],writer:r[i]||r.default}}const e={get array(){return[]},boolean:false,number:0,get object(){return{}},string:""};const t={array(e){const t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError("Expected array");return t},boolean(e){return!("0"==e||"false"==e)},number(e){return Number(e)},object(e){const t=JSON.parse(e);if(null===t||"object"!=typeof t||Array.isArray(t))throw new TypeError("Expected object");return t},string(e){return e}};const r={default:writeString,array:writeJSON,object:writeJSON};function writeJSON(e){return JSON.stringify(e)}function writeString(e){return`${e}`}class Controller{constructor(e){this.context=e}static get shouldLoad(){return true}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:r={},prefix:n=this.identifier,bubbles:o=true,cancelable:i=true}={}){const s=n?`${n}:${e}`:e;const c=new CustomEvent(s,{detail:r,bubbles:o,cancelable:i});t.dispatchEvent(c);return c}}Controller.blessings=[ClassPropertiesBlessing,TargetPropertiesBlessing,ValuePropertiesBlessing];Controller.targets=[];Controller.values={};var n="undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function addEvent(e,t,r){e.addEventListener?e.addEventListener(t,r,false):e.attachEvent&&e.attachEvent("on".concat(t),(function(){r(window.event)}))}function getMods(e,t){var r=t.slice(0,t.length-1);for(var n=0;n<r.length;n++)r[n]=e[r[n].toLowerCase()];return r}function getKeys(e){"string"!==typeof e&&(e="");e=e.replace(/\s/g,"");var t=e.split(",");var r=t.lastIndexOf("");for(;r>=0;){t[r-1]+=",";t.splice(r,1);r=t.lastIndexOf("")}return t}function compareArray(e,t){var r=e.length>=t.length?e:t;var n=e.length>=t.length?t:e;var o=true;for(var i=0;i<r.length;i++)-1===n.indexOf(r[i])&&(o=false);return o}var o={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":n?173:189,"=":n?61:187,";":n?59:186,"'":222,"[":219,"]":221,"\\":220};var i={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91};var s={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91};var c={16:false,18:false,17:false,91:false};var u={};for(var l=1;l<20;l++)o["f".concat(l)]=111+l;var f=[];var p="all";var d=[];var y=function code(e){return o[e.toLowerCase()]||i[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function setScope(e){p=e||"all"}function getScope(){return p||"all"}function getPressedKeyCodes(){return f.slice(0)}function filter(e){var t=e.target||e.srcElement;var r=t.tagName;var n=true;!t.isContentEditable&&("INPUT"!==r&&"TEXTAREA"!==r&&"SELECT"!==r||t.readOnly)||(n=false);return n}function isPressed(e){"string"===typeof e&&(e=y(e));return-1!==f.indexOf(e)}function deleteScope(e,t){var r;var n;e||(e=getScope());for(var o in u)if(Object.prototype.hasOwnProperty.call(u,o)){r=u[o];for(n=0;n<r.length;)r[n].scope===e?r.splice(n,1):n++}getScope()===e&&setScope(t||"all")}function clearModifier(e){var t=e.keyCode||e.which||e.charCode;var r=f.indexOf(t);r>=0&&f.splice(r,1);e.key&&"meta"===e.key.toLowerCase()&&f.splice(0,f.length);93!==t&&224!==t||(t=91);if(t in c){c[t]=false;for(var n in i)i[n]===t&&(hotkeys[n]=false)}}function unbind(e){if(e){if(Array.isArray(e))e.forEach((function(e){e.key&&h(e)}));else if("object"===typeof e)e.key&&h(e);else if("string"===typeof e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=r[0],i=r[1];if("function"===typeof o){i=o;o=""}h({key:e,scope:o,method:i,splitKey:"+"})}}else Object.keys(u).forEach((function(e){return delete u[e]}))}var h=function eachUnbind(e){var t=e.key,r=e.scope,n=e.method,o=e.splitKey,s=void 0===o?"+":o;var c=getKeys(t);c.forEach((function(e){var t=e.split(s);var o=t.length;var c=t[o-1];var l="*"===c?"*":y(c);if(u[l]){r||(r=getScope());var f=o>1?getMods(i,t):[];u[l]=u[l].map((function(e){var t=!n||e.method===n;return t&&e.scope===r&&compareArray(e.mods,f)?{}:e}))}}))};function eventHandler(e,t,r){var n;if(t.scope===r||"all"===t.scope){n=t.mods.length>0;for(var o in c)Object.prototype.hasOwnProperty.call(c,o)&&(!c[o]&&t.mods.indexOf(+o)>-1||c[o]&&-1===t.mods.indexOf(+o))&&(n=false);if((0===t.mods.length&&!c[16]&&!c[18]&&!c[17]&&!c[91]||n||"*"===t.shortcut)&&false===t.method(e,t)){e.preventDefault?e.preventDefault():e.returnValue=false;e.stopPropagation&&e.stopPropagation();e.cancelBubble&&(e.cancelBubble=true)}}}function dispatch(e){var t=u["*"];var r=e.keyCode||e.which||e.charCode;if(hotkeys.filter.call(this,e)){93!==r&&224!==r||(r=91);-1===f.indexOf(r)&&229!==r&&f.push(r);["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var r=s[t];e[t]&&-1===f.indexOf(r)?f.push(r):!e[t]&&f.indexOf(r)>-1?f.splice(f.indexOf(r),1):"metaKey"===t&&e[t]&&3===f.length&&(e.ctrlKey||e.shiftKey||e.altKey||(f=f.slice(f.indexOf(r))))}));if(r in c){c[r]=true;for(var n in i)i[n]===r&&(hotkeys[n]=true);if(!t)return}for(var o in c)Object.prototype.hasOwnProperty.call(c,o)&&(c[o]=e[s[o]]);if(e.getModifierState&&!(e.altKey&&!e.ctrlKey)&&e.getModifierState("AltGraph")){-1===f.indexOf(17)&&f.push(17);-1===f.indexOf(18)&&f.push(18);c[17]=true;c[18]=true}var l=getScope();if(t)for(var p=0;p<t.length;p++)t[p].scope===l&&("keydown"===e.type&&t[p].keydown||"keyup"===e.type&&t[p].keyup)&&eventHandler(e,t[p],l);if(r in u)for(var d=0;d<u[r].length;d++)if(("keydown"===e.type&&u[r][d].keydown||"keyup"===e.type&&u[r][d].keyup)&&u[r][d].key){var h=u[r][d];var g=h.splitKey;var v=h.key.split(g);var b=[];for(var m=0;m<v.length;m++)b.push(y(v[m]));b.sort().join("")===f.sort().join("")&&eventHandler(e,h,l)}}}function isElementBind(e){return d.indexOf(e)>-1}function hotkeys(e,t,r){f=[];var n=getKeys(e);var o=[];var s="all";var c=document;var l=0;var p=false;var h=true;var g="+";void 0===r&&"function"===typeof t&&(r=t);if("[object Object]"===Object.prototype.toString.call(t)){t.scope&&(s=t.scope);t.element&&(c=t.element);t.keyup&&(p=t.keyup);void 0!==t.keydown&&(h=t.keydown);"string"===typeof t.splitKey&&(g=t.splitKey)}"string"===typeof t&&(s=t);for(;l<n.length;l++){e=n[l].split(g);o=[];e.length>1&&(o=getMods(i,e));e=e[e.length-1];e="*"===e?"*":y(e);e in u||(u[e]=[]);u[e].push({keyup:p,keydown:h,scope:s,mods:o,shortcut:n[l],method:r,key:n[l],splitKey:g})}if("undefined"!==typeof c&&!isElementBind(c)&&window){d.push(c);addEvent(c,"keydown",(function(e){dispatch(e)}));addEvent(window,"focus",(function(){f=[]}));addEvent(c,"keyup",(function(e){dispatch(e);clearModifier(e)}))}}var g={setScope:setScope,getScope:getScope,deleteScope:deleteScope,getPressedKeyCodes:getPressedKeyCodes,isPressed:isPressed,filter:filter,unbind:unbind};for(var v in g)Object.prototype.hasOwnProperty.call(g,v)&&(hotkeys[v]=g[v]);if("undefined"!==typeof window){var b=window.hotkeys;hotkeys.noConflict=function(e){e&&window.hotkeys===hotkeys&&(window.hotkeys=b);return hotkeys};window.hotkeys=hotkeys}let m=function(e){_inherits(_default,e);var t=_createSuper(_default);function _default(...e){var r;_classCallCheck(this,_default);r=t.call(this,...e);_defineProperty(_assertThisInitialized(r),"map",(e=>{try{const t=e[1].includes(":prevent");const[n,o]=[e[0],e[1].replace(":prevent","")];const[i,s]=o.includes("->")?o.split("->"):[null,o];const[c,...u]=s.split("#");const l=u[0].split("(")[0];const f=i?document.querySelector(i):r.element;const p=r.application.getControllerForElementAndIdentifier(f,c);const d=u.join("#").match(/^.+\((.*)\)$/);const y=d?d[1].split(",").map((e=>{const t=e.trim().match(/^["']?((?:\\.|[^"'\\])*)["']?$/)[1];return"true"===t||"false"!==t&&(isNaN(t)?t:Number(t))})):[];if("string"===typeof n&&"function"===typeof p[l])return t?[n,e=>{e.preventDefault();p[l].bind(p,...y)()}]:[n,p[l].bind(p,...y)]}catch(e){}}));return r}_createClass(_default,[{key:"initialize",value:function initialize(){this.actOnHotkeys=this.actOnHotkeys.bind(this);this.connected=false}},{key:"connect",value:function connect(){this.actOnHotkeys(hotkeys);this.connected=true}},{key:"disconnect",value:function disconnect(){this.actOnHotkeys(hotkeys.unbind);this.connected=false}},{key:"bindingsValueChanged",value:function bindingsValueChanged(){this.connected&&this.actOnHotkeys(hotkeys.unbind);this.bindings=Object.entries(this.bindingsValue);this.connected&&this.actOnHotkeys(hotkeys)}},{key:"actOnHotkeys",value:function actOnHotkeys(e){setTimeout((()=>this.bindings.map(this.map).filter((e=>"object"===typeof e)).forEach((t=>e.apply(null,t)))),1)}}]);return _default}(Controller);_defineProperty(m,"values",{bindings:Object});export{m as default};

